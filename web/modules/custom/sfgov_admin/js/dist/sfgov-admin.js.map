{"version":3,"sources":["sfgov-admin.js"],"names":["$","Drupal","document","window","behaviors","sfgovAdminToolbarReizeTweak","attach","context","matchMedia","addListener","event","matches","click","sfgovAdminSidebarToggle","once","wrapInner","prepend","t","on","preventDefault","$container","$sidebar","hasClass","show","removeClass","hide","addClass","not","sfgovParagraphAddDropbutton","e","target","closest","toggleClass","sfgovTabledragHandle","settings","each","index","el","html","sfgovPersonContentTypeName","val","submit","sfgovFormatTelephone","phoneField","length","regex","RegExp","number","match","join","slice","sfgovTransactionSortTitle","stripStopWords","str","strArray","split","stopWords","inArray","toLowerCase","splice","charAt","toUpperCase","isTransactionEdit","sortTitle","sfgovDeptReqRecords","associations","reqPublicRecords","parent","key","radioVal","checkedVal","jQuery"],"mappings":"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","file":"sfgov-admin.js","sourcesContent":["/**\n * @file\n * General tweaks for the administrative user interface. This file is loaded on\n * all pages where the administrative theme is in use.\n */\n(function($, Drupal, document, window) {\n\n  /**\n   * Prevents the Administrative Toolbar from popping out as a sidebar when\n   * screen width is reduced.\n   */\n  Drupal.behaviors.sfgovAdminToolbarReizeTweak = {\n    attach: function (context) {\n      window.matchMedia('(min-width: 975px)').addListener(function(event) {\n        event.matches ? $('#toolbar-item-administration', context).click() : $('.toolbar-item.is-active', context).click();\n      });\n    }\n  };\n\n  /**\n   * Adds a button that Toggles the Node edit form sidebar.\n   */\n  Drupal.behaviors.sfgovAdminSidebarToggle = {\n    attach: function (context) {\n\n      $('.layout-region-node-secondary', context).once('sidebarToggle')\n        .wrapInner('<div id=\"sidebar-toggle-content\"/>')\n        .prepend('<button id=\"sidebar-toggle\" class=\"sidebar-toggle\"><span class=\"sidebar-toggle__text\">' + Drupal.t('Toggle sidebar') + '</span><span class=\"sidebar-toggle__icon\"></span></button>');\n\n      $('#sidebar-toggle', context).once().on('click', function(event) {\n        event.preventDefault();\n        var $container = $('.layout-node-form', context);\n        var $sidebar = $('#sidebar-toggle-content', context);\n\n        if ($container.hasClass('sidebar-toggle-active')) {\n          $sidebar.show();\n          $container.removeClass('sidebar-toggle-active');\n        }\n        else {\n          $sidebar.hide();\n          $container.addClass('sidebar-toggle-active');\n        }\n      });\n\n      // This media query maps to the Seven theme's breakpoint for when the\n      // sidebar appears in the right column. When the screen resized from a\n      // large width, to a smaller width, and the sidebar appears below the\n      // content, this initiates a click on the toggle to show the sidebar.\n      window.matchMedia('screen and (max-width: 780px), (max-device-height: 780px) and (orientation: landscape)').addListener(function(event) {\n        if (event.matches && $('#sidebar-toggle-content', context).not(':visible')) {\n          $('#sidebar-toggle', context).click();\n        }\n      });\n\n    }\n  };\n\n  /**\n   * Enables Dropbutton functionality on the custom \"Add Drop Button\" widget.\n   */\n  Drupal.behaviors.sfgovParagraphAddDropbutton = {\n    attach: function (context) {\n      // The add button is just a placeholder for the add buttons. Clicking it should have no affect.\n      $('.sfgov-admin-paragraph-add-link', context).once().on('click', function (e) {\n        e.preventDefault();\n        $(e.target).closest('.dropbutton-wrapper').toggleClass('open');\n      });\n    }\n  };\n\n   /**\n    * Add SVG icon to tabledrag handle.\n    */\n  Drupal.behaviors.sfgovTabledragHandle = {\n    attach: function(context, settings) {\n      $('.form-item-custom-paragraph div.handle, .form-item-custom-autocomplete div.handle', context).once('tabledrag-handle-override').each(function (index, el) {\n        $(this).html('<svg class=\"paragraphs-tabledrag-handle\" width=\"32\" height=\"32\" viewBox=\"0 0 32 32\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\"><path d=\"M14.752,4 L1.25,4 C0.56,4 0,4.37333333 0,4.83333333 L0,5.16666667 C0,5.626 0.56,6 1.25,6 L14.752,6 C15.441,6 16.002,5.626 16.002,5.16666667 L16.002,4.83333333 C16.002,4.37333333 15.441,4 14.752,4 L14.752,4 L14.752,4 Z M1.25,0 C0.56,0 0,0.373333333 0,0.833333333 L0,1.16666667 C0,1.62666667 0.56,2 1.25,2 L14.752,2 C15.441,2 16.002,1.62666667 16.002,1.16666667 L16.002,0.833333333 C16.002,0.373333333 15.441,0 14.752,0 L1.25,0 L1.25,0 Z M14.752,8 L1.25,8 C0.56,8 0,8.374 0,8.83333333 L0,9.16666667 C0,9.626 0.56,10 1.25,10 L14.752,10 C15.441,10 16.002,9.626 16.002,9.16666667 L16.002,8.83333333 C16.002,8.374 15.441,8 14.752,8 L14.752,8 L14.752,8 Z\"></path></svg>');\n      });\n    }\n  }\n\n  Drupal.behaviors.sfgovPersonContentTypeName = {\n    attach: function (context) {\n      $('.node-person-form #edit-submit, .node-person-edit-form').click(function() {\n        $('#edit-title-0-value').val($('#edit-field-first-name-0-value').val() + ' ' + $('#edit-field-last-name-0-value').val());\n        $('form.node-person-form, form.node-person-edit-form').submit(function() {\n          $('#edit-title-0-value').val($('#edit-field-first-name-0-value').val() + ' ' + $('#edit-field-last-name-0-value').val());\n          return true;\n        });\n      });\n    }\n  }\n\n  // Enforce telephone numbers have format XXX-XXX-XXXX\n  Drupal.behaviors.sfgovFormatTelephone = {\n    attach: function(context, settings) {\n      $('#edit-submit').once().on('click', function(e) {\n        var phoneField = $('.form-tel');\n        if (phoneField.length > 0) {\n          var regex = new RegExp(\"\\\\d+\", \"g\");\n          if(phoneField.val().length > 0) {\n            var number = phoneField.val().match(regex).join(\"\");\n            if (number.length == 10) {\n              phoneField.val(number.slice(0,3) + \"-\" + number.slice(3,6) + \"-\" + number.slice(6));\n            }\n          }\n        }\n      })\n    }\n  }\n\n  // populate the sort title for transactions based on the title (excluding stop words at the beginning of a title)\n  // for example, sort title for \"Apply for a loan to repair your home\" would be \"Loan to repair your home\"\n  // this sort title is used in the services a-z view to group and sort the transaction titles\n  // refer to:\n  //  - transaction content type\n  //  - services page view a-z\n  Drupal.behaviors.sfgovTransactionSortTitle = {\n    attach: function(context, settings) {\n      var stripStopWords = function(str) {\n        var strArray = str.split(' ');\n        var stopWords = [\"a\", \"an\", \"apply\", \"as\", \"be\", \"find\", \"for\", \"get\", \"have\", \"register\", \"the\", \"to\", \"your\"];\n        while($.inArray(strArray[0].toLowerCase(), stopWords) >= 0) {\n          strArray.splice(0, 1);\n        }\n        strArray[0] = strArray[0].charAt(0).toUpperCase() + strArray[0].slice(1);\n        return strArray.join(' ');\n      };\n      var isTransactionEdit = $('form.node-transaction-edit-form').length > 0 || $('form.node-transaction-form').length > 0 ? true : false;\n      if(isTransactionEdit) {\n        $('#edit-submit').on('click', function() {\n          var sortTitle = stripStopWords($('#edit-title-0-value').val());\n          $('#edit-field-sort-title-0-value').val(sortTitle);\n        });\n      }\n    }\n  }\n\n  Drupal.behaviors.sfgovDeptReqRecords = {\n    attach: function(context, settings) {\n      var associations = {\n        \"phone\": \"edit-field-req-public-records-phone-wrapper\",\n        \"link\": \"edit-field-req-public-records-link-wrapper\",\n        \"email\": \"edit-field-req-public-records-email-wrapper\"\n      }\n      var reqPublicRecords = function() {\n        // a key value pair of radio buttons values and wrapper id's for show/hide\n        $('#edit-field-req-public-records-none').parent().hide();\n        $('#edit-field-req-public-records input[type=\"radio\"]').once().on('click', function() {\n          for(var key in associations) {\n            $('#' + associations[key]).hide();\n          }\n          var radioVal = $(this).val().toLowerCase();\n          $('#' + associations[radioVal]).show();\n        });\n      };\n      var checkedVal = $('input[name=\"field_req_public_records\"]:checked').val();\n      if(checkedVal) {\n        $('#' + associations[checkedVal.toLowerCase()]).show();\n      }\n      reqPublicRecords();\n      \n    }\n  }\n\n}(jQuery, Drupal, document, window));\n"]}