#!/bin/bash

set -eo pipefail

samlTestConfig=$(pwd)"/web/sites/default/files/private/saml/test/config"
samlTestMetadata=$(pwd)"/web/sites/default/files/private/saml/test/metadata"
samlLiveConfig=$(pwd)"/web/sites/default/files/private/saml/live/config"
samlLiveMetadata=$(pwd)"/web/sites/default/files/private/saml/live/metadata"

samlConfig=$(pwd)"/vendor/simplesamlphp/simplesamlphp/config"
samlMetadata=$(pwd)"/vendor/simplesamlphp/simplesamlphp/metadata"

# remove existing simplesamlphp config and metadata directories
rm -vrf $samlConfig
rm -vrf $samlMetadata
rm -vrf $(pwd)"/web/private/saml" # remove residual saml things from pantheon codebase

# create necessary (empty) directories to symlink
mkdir -p $samlTestConfig
mkdir -p $samlTestMetadata
mkdir -p $samlLiveConfig
mkdir -p $samlLiveMetadata

# linkConfig=$samlTestConfig
# linkMetadata=$samlTestMetadata

# if [[ $TERMINUS_ENV == "live" ]] ; then
#   linkConfig=$samlLiveConfig
#   linkMetadata=$samlLiveMetadata
# fi

# # symlink config and metadata
# ln -s $linkConfig $samlConfig
# ln -s $linkMetadata $samlMetadata
